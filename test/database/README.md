# Тесты для базы данных GTD Manager

Этот файл содержит комплексные тесты для CRUD операций базы данных GTD Manager, написанные с использованием Drift и тестового фреймворка Dart.

## Структура тестов

### 1. Заметки (Notes)
- ✅ Создание заметки
- ✅ Создание заметки с проектом
- ✅ Получение всех заметок
- ✅ Получение заметки по ID
- ✅ Обновление заметки
- ✅ Частичное обновление заметки
- ✅ Удаление заметки
- ✅ Обработка ошибок при получении несуществующей заметки

### 2. Проекты (Projects)
- ✅ Создание проекта
- ✅ Создание подпроекта
- ✅ Обновление проекта
- ✅ Удаление проекта

### 3. Теги (Tags)
- ✅ Создание тега
- ✅ Проверка уникальности тегов
- ✅ Обновление тега
- ✅ Удаление тега

### 4. Связи между таблицами
- ✅ Связь заметки с тегом
- ✅ Связь проекта с тегом
- ✅ Удаление заметки с тегами (проверка поведения без каскадного удаления)

### 5. Валидация и ограничения
- ✅ Ограничение длины заголовка заметки (максимум 100 символов)
- ✅ Ограничение длины заголовка проекта (максимум 100 символов)
- ✅ Ограничение длины названия тега (максимум 100 символов)
- ✅ Пустой заголовок заметки недопустим
- ✅ Проект не может быть родителем самого себя

### 6. Сложные запросы
- ✅ Получение заметок по категории
- ✅ Получение проектов по статусу
- ✅ Подсчет заметок по категориям

## Особенности реализации

1. **Тестовая база данных**: Используется `NativeDatabase.memory()` для создания изолированной тестовой базы данных в памяти
2. **Настройка и очистка**: Каждый тест выполняется в изолированной среде с автоматической очисткой после завершения
3. **Проверка исключений**: Тесты проверяют корректную обработку ошибок валидации и несуществующих записей
4. **Типизация**: Используются правильные типы Drift для всех операций с базой данных

## Запуск тестов

```bash
flutter test test/database/database_operations_test.dart
```

Все тесты проходят успешно и покрывают основные сценарии использования базы данных.
